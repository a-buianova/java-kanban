# java-kanban

**Repository for a homework project:**  
[https://github.com/a-buianova/java-kanban.git](https://github.com/a-buianova/java-kanban.git)

---

## Реализованные функции

- **Создание задач, эпиков и подзадач:** Возможность создавать объекты разных типов с уникальными идентификаторами.
- **Расчёт полей времени:** `startTime`, `duration`, `endTime` для `Task` и `SubTask`. У `Epic` поля рассчитываются автоматически на основе подзадач.
- **Обновление статусов:** Поддержка статусов `NEW`, `IN_PROGRESS` и `DONE`. Статус `Epic` обновляется автоматически.
- **Удаление задач:** Удаление задач, эпиков и подзадач по ID. При удалении эпика все его подзадачи также удаляются.
- **История просмотров:** История без повторов и ограничений по размеру. Удаление выполняется за O(1).
- **Приоритетная сортировка задач:** Используется `TreeSet` по `startTime` (null — в конце). Метод `getPrioritizedTasks()` возвращает отсортированный список.
- **Проверка пересечений:** Проверка при создании и обновлении, используется `Stream API`. При пересечении выбрасывается исключение.
- **Сортировка по статусу:** Получение задач и подзадач, отсортированных по статусу.
- **Проверка корректности:** Поддержка уникальности ID. Эпик не может быть своей подзадачей. Подзадача не может ссылаться на несуществующий эпик.
- **Работа с CSV:** Сохранение/восстановление задач, эпиков, подзадач и истории в CSV-файл.
- **Поддержка `Optional`:** Методы поиска по ID возвращают `Optional<T>`.
- **Полная реализация требований ТЗ 8-го спринта.**

---

## Тестирование

- **Создание и удаление:** Проверка корректного создания и удаления задач, эпиков и подзадач.
- **История:** Проверка истории без дублей, удаления из истории, восстановления из файла.
- **Статусы эпиков:** Проверка логики изменения статуса в зависимости от статусов подзадач.
- **Расчёт времени:** Проверка `startTime`, `endTime`, `duration` у эпиков.
- **Сериализация:** Проверка сохранения и загрузки задач, включая поля времени.
- **Пересечения:** Проверка обработки пересекающихся задач.
- **Приоритеты:** Проверка правильной сортировки задач по времени.
- **Граничные кейсы:** Удаление задач из начала, середины и конца истории, пустая история, задачи без времени.

---

## Как организована программа

1. **`Task`** — базовый класс. Поля: `id`, `name`, `description`, `status`, `startTime`, `duration`. `getEndTime()` — вычисляемое поле.
2. **`Epic`** — наследуется от `Task`. Хранит список `subtaskIds`. Поля времени рассчитываются по подзадачам.
3. **`SubTask`** — наследуется от `Task`, содержит `epicId`.
4. **`InMemoryTaskManager`** — логика создания, обновления, удаления задач, проверка пересечений, история, сортировка.
5. **`FileBackedTaskManager`** — добавляет сохранение и загрузку из `.csv`-файла.
6. **`TaskConverter`** — сериализация/десериализация задач.
7. **`InMemoryHistoryManager`** — история просмотров: двусвязный список + `HashMap`.
8. **Интерфейсы `TaskManager`, `HistoryManager`** — описывают контракт для менеджеров.
9. **`Managers`** — фабрика для получения экземпляров менеджеров.

---

## Принципы ООП

- **Инкапсуляция:** Поля скрыты, доступ через методы.
- **Наследование:** `Epic` и `SubTask` расширяют `Task`.
- **Полиморфизм:** Методы `getType()` и `toString()` переопределены в подклассах.

---

## Хранение данных

- **Задачи, эпики, подзадачи** — хранятся в `HashMap` по ID.
- **История** — через двусвязный список и `Map` ID → Node.
- **Приоритеты** — через `TreeSet`, где сортировка по `startTime`.
- **Файл** — задачи и история сохраняются и восстанавливаются из `.csv`.

---

## Интерфейс

- Используются интерфейсы `TaskManager` и `HistoryManager`, обеспечивая гибкость и возможность смены реализации (например, на файловую или серверную).